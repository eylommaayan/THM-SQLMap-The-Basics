# THM-SQLMap-The-Basics
SQLMap הוא כלי קוד פתוח המיועד לאוטומציה של זיהוי וניצול חולשות מסוג SQL Injection (SQLi). במקום להזין ידנית גרשיים ופקודות SQL מורכבות, הכלי עושה זאת עבורנו במהירות וביעילות.  למה הוא כל כך חזק? תמיכה רחבה: עובד עם כמעט כל סוגי מסדי הנתונים (MySQL, PostgreSQL, Oracle, MSSQL ועוד).
* <img width="1780" height="856" alt="image" src="https://github.com/user-attachments/assets/6c06dc84-62f2-4542-914e-618a67b87416" />


בשמחה! נראה שאתה עובד על בניית מדריך (PT (Penetration Testing ב-GitHub עבור החדר של SQLMap ב-TryHackMe.

הנה ריכוז של הבסיס שאתה צריך להכיר ולהעביר הלאה, כתוב בצורה מקצועית וברורה:

---

## 🛠️ מה זה בעצם SQLMap?

**SQLMap** הוא כלי קוד פתוח המיועד לאוטומציה של זיהוי וניצול חולשות מסוג **SQL Injection (SQLi)**. במקום להזין ידנית גרשיים ופקודות SQL מורכבות, הכלי עושה זאת עבורנו במהירות וביעילות.

### למה הוא כל כך חזק?

* **תמיכה רחבה:** עובד עם כמעט כל סוגי מסדי הנתונים (MySQL, PostgreSQL, Oracle, MSSQL ועוד).
* **גילוי אוטומטי:** הוא יודע לזהות לבד איזה סוג הזרקה עובד (Blind, Error-based, Union-based).
* **שליטה מלאה:** מאפשר לשלוף טבלאות, להוריד נתונים, ואפילו לנסות להשיג Shell על השרת.

---

## 🚀 פקודות בסיסיות (צ'יט-שיט למדריך שלך)

כאשר אתה כותב את המדריך ב-GitHub, כדאי לחלק את הפקודות לפי שלבים:

| מטרה | פקודה |
| --- | --- |
| **סריקה בסיסית** | `sqlmap -u "http://target.com/page.php?id=1"` |
| **מציאת מסדי נתונים** | `sqlmap -u "URL" --dbs` |
| **הצגת טבלאות** | `sqlmap -u "URL" -D db_name --tables` |
| **שליפת נתונים (Dump)** | `sqlmap -u "URL" -D db_name -T users --dump` |
| **בדיקת בקשה מקובץ (Burp)** | `sqlmap -r request.txt` |

---


3. **אנונימיות:** ציין את האפשרות להשתמש ב-`--proxy` או `--tor` כדי להסתיר את זהות התוקף.

---
.

---

# מדריך: פגיעות SQL Injection (הזרקת SQL)

במשימה הקודמת למדנו כיצד אתרים ואפליקציות מתקשרים עם מסדי נתונים כדי לאחסן, לשנות ולשלוף נתונים בצורה מובנית. במשימה זו נראה כיצד האינטראקציה הזו מתבצעת בפועל דרך שאילתות SQL, וכיצד תוקפים מנצלים זאת לביצוע מתקפות SQL Injection.

> **הערה חשובה:** לפני שנמשיך, ודאו שאתם מנסים שיטות הזרקה ידניות או אוטומטיות רק לאחר קבלת אישור מפורש מבעל האפליקציה.

---

## 1. כיצד עובד תהליך התחברות תקין (Login)

נניח שיש לנו דף התחברות המבקש שם משתמש וסיסמה. נזין את הנתונים הבאים:

* **שם משתמש:** John
* **סיסמה:** Un@detectable444

ברגע שתזינו את הנתונים, האתר יקבל אותם, יבנה שאילתת SQL וישלח אותה למסד הנתונים:


**מה קורה במסד הנתונים?**
השאילתה תתבצע, ומסד הנתונים יבדוק אם קיים משתמש בשם `John` עם הסיסמה המדויקת שנשלחה. בגלל השימוש באופרטור הבוליאני **AND**, השאילתה תצליח רק אם **גם** שם המשתמש **וגם** הסיסמה תואמים למה ששמור במערכת. אם נמצאה התאמה, פרטי המשתמש יוחזרו לאפליקציה והוא יחובר למערכת.

---

## 2. הבנת הפגיעות (The Vulnerability)

לפעמים, כאשר הקלט של המשתמש אינו עובר "ניקוי" (Sanitization) או אימות (Validation), תוקפים יכולים לתמרן את הקלט ולכתוב שאילתות SQL שירוצו במסד הנתונים ויבצעו פעולות שהתוקף חפץ בהן.

להזרקת SQL יש השפעה הרסנית, מכיוון שארגונים מאחסנים את כל המידע הקריטי שלהם בתוך מסדי נתונים. מתקפה מוצלחת יכולה להוביל לחשיפת מידע רגיש.

---

## 3. כיצד מתבצעת המתקפה?

נניח שדף ההתחברות שדיברנו עליו אינו מבצע אימות קלט (פגיע ל-SQLi). התוקף אינו יודע את הסיסמה של John, ולכן הוא יזין את הפרטים הבאים:

* **שם משתמש:** John
* **סיסמה:** `abc' OR 1=1;-- -`

השאילתה שהאתר ישלח למסד הנתונים תיראה כעת כך:


### פירוק השאילתה המניפולטיבית:

1. **הגרש הבודד (`'`):** הגרש שמופיע אחרי ה-`abc` סוגר את מחרוזת הטקסט המקורית של הסיסמה בשאילתה.
2. **התנאי `OR 1=1`:** האופרטור `OR` בודק אם לפחות אחד מהצדדים אמת. מכיוון ש-`1=1` הוא תמיד אמת (**True**), כל התנאי הופך לאמת, ללא קשר לשאלה אם הסיסמה `abc` נכונה או לא.
3. **הסימנים `;-- -`:** אלו סימני "הערה" (Comment) ב-SQL. הם גורמים למסד הנתונים להתעלם מכל מה שכתוב אחריהם בשאילתה (כמו הגרש הסוגר המקורי של הקוד), ובכך מונעים שגיאת תחביר.

**התוצאה:** השאילתה מתבצעת בהצלחה, ומסד הנתונים "משתכנע" שהפרטים נכונים. התוקף יחובר לחשבון של John מבלי לדעת את הסיסמה.

---

## תשובות לשאלות המשימה (Task 2)

* **שאלה:** איזה אופרטור בוליאני בודק אם לפחות צד אחד של האופרטור הוא אמת כדי שהתנאי כולו יהיה אמת?
* **תשובה:** `OR`


* **שאלה:** האם הביטוי `1=1` בשאילתת SQL הוא תמיד אמת? (YEA/NAY)
* **תשובה:** `YEA`



---
<img width="1753" height="586" alt="image" src="https://github.com/user-attachments/assets/54f899ca-77ac-4b76-b79c-497c38e7175d" />

#:

---

# מדריך: כלי הזרקת SQL אוטומטי (SQLMap)

ביצוע מתקפת SQL Injection ידנית דורש זמן רב: גילוי נקודת התורפה, זיהוי סוג מסד הנתונים, ובניית שאילתות לשליפת המידע. **SQLMap** הוא הכלי המוביל בעולם לאוטומציה של התהליך הזה.

> **הערה:** הפקודות במשימה זו הן לצורך הדגמה על אתר דמיוני (`http://sqlmaptesting.thm`). במשימה הבאה תבצעו תרגול מעשי על אתר חי.

---

## 🛠️ התחלת עבודה עם SQLMap

SQLMap הוא כלי מבוסס שורת פקודה (CLI). אם אתם מתחילים וחוששים מכל הדגלים (Flags), הכלי מציע "אשף" (Wizard) שידריך אתכם צעד אחר צעד:

```bash
sqlmap --wizard

```

### 1. סריקה בסיסית (GET-based)

כאשר אתר משתמש בפרמטרים בכתובת ה-URL (כמו `?cat=1`), אנו משתמשים בדגל `-u`.
דוגמה לסריקה המזהה אם הפרמטר פגיע:

```bash
sqlmap -u http://sqlmaptesting.thm/search/cat=1

```

בשלב זה SQLMap יבצע בדיקות היוריסטיות, יבדוק אם יש WAF (חומת אש לאפליקציות) ויזהה את סוג ההזרקה (למשל: Time-based blind או UNION query).

### 2. שימוש בעוגיות (Cookie-based)

לפעמים דפים פגיעים נמצאים מאחורי דף התחברות. במקרה כזה, נצטרך לספק ל-SQLMap את ה-Cookie שלנו כדי שיוכל לגשת לדף כמשתמש מחובר:

```bash
sqlmap -u "http://target.com/admin" --cookie="PHPSESSID=abcdef123456"

```

### 3. בדיקת בקשות POST

במקרים של טפסי התחברות או הרשמה, הנתונים לא מופיעים ב-URL אלא בגוף הבקשה (Body). הדרך המקצועית ביותר לעשות זאת היא לשמור את הבקשה מתוך Burp Suite לקובץ טקסט ולהריץ:

```bash
sqlmap -r request.txt

```

---

## 📊 שלבי שליפת המידע (Enumeration)

אחרי שווידאנו שהאתר פגיע, נתקדם בשלבים הבאים כדי להוציא את המידע:

| שלב | המטרה | הפקודה |
| --- | --- | --- |
| **שלב 1** | מציאת שמות מסדי הנתונים | `sqlmap -u [URL] --dbs` |
| **שלב 2** | מציאת טבלאות במסד נתונים ספציפי | `sqlmap -u [URL] -D [db_name] --tables` |
| **שלב 3** | שליפת הנתונים מתוך טבלה | `sqlmap -u [URL] -D [db_name] -T [table_name] --dump` |

---

## תשובות לשאלות המשימה (Task 3)

* **שאלה:** באיזה דגל בכלי SQLMap משתמשים כדי לשלוף את כל מסדי הנתונים הזמינים?
* **תשובה:** `--dbs`


* **שאלה:** מה תהיה הפקודה המלאה ב-SQLMap לצורך שליפת כל הטבלאות מתוך מסד הנתונים "members"? (כתובת האתר: `http://sqlmaptesting.thm/search/cat=1`)
* **תשובה:** `sqlmap -u http://sqlmaptesting.thm/search/cat=1 -D members --tables`

<img width="1788" height="479" alt="image" src="https://github.com/user-attachments/assets/5a17fded-0187-45a9-9f62-06eb32d0a411" />


המטרה שלנו היא לנצל פגיעות SQL Injection בדף התחברות (Login) שמשתמש בבקשות מסוג GET, אך מסתיר את הפרמטרים מה-URL הראשוני. נשתמש בכלי הסטנדרטי בתעשייה, SQLMap, כדי לשאוב מידע מבסיס הנתונים.

שלב 1: איסוף הנתונים (Enumeration)
לפני שנריץ את הכלים הכבדים, אנחנו צריכים את הכתובת המלאה שכוללת את הפרמטרים שנשלחים לשרת. כפי שצוין, הכתובת היא:
http://10.113.167.35/ai/includes/user_login?email=test&password=test

בשביל להשיג גישה לאתר נזין נתונים מומצאים כמו שם משתמש וסיסימא chack

<img width="1857" height="837" alt="image" src="https://github.com/user-attachments/assets/f191c99f-d062-4df9-a1ce-a3adf30f6839" />
נקבל את ה-get של האתר נעתיק את הכתובת לטרמינל ונריץ sqlmap

<img width="1880" height="886" alt="image" src="https://github.com/user-attachments/assets/07b5c813-e397-41fb-b3d9-fd3c4f77ed1c" />


שלב 2: זיהוי בסיסי הנתונים (Databases)
נריץ סריקה עמוקה כדי לגלות כמה בסיסי נתונים קיימים בשרת. שימו לב לתוספת --level=5 כדי להבטיח סריקה יסודית.

הפקודה:

Bash
sqlmap -u 'http://10.113.167.35/ai/includes/user_login?email=test&password=test' --level=5 --dbs
מה הפקודה עושה? הסיומת --dbs אומרת ל-SQLMap להציג את רשימת בסיסי הנתונים (Databases).

במהלך ההרצה: תתבקשו לענות על שאלות (השיבו y או n לפי ההנחיות במשימה).

תשובה לשאלה 1: לאחר סיום הסריקה, ספרו כמה בסיסי נתונים מופיעים תחת ה-output. (בדרך כלל תראו information_schema ובסיסי נתונים של האפליקציה).

<img width="1900" height="847" alt="image" src="https://github.com/user-attachments/assets/4735e350-6b66-4937-a4dc-24e7f0f311eb" />

שלב 3: חשיפת טבלאות בתוך בסיס הנתונים "ai"
עכשיו כשאנחנו יודעים שיש בסיס נתונים בשם ai, בואו נראה אילו טבלאות הוא מכיל.

הפקודה:

Bash
sqlmap -u 'http://10.113.167.35/ai/includes/user_login?email=test&password=test' --level=5 -D ai --tables
-D ai: מגדיר ל-SQLMap לעבוד על בסיס הנתונים הספציפי בשם ai.

--tables: מבקש רשימה של כל הטבלאות בתוך אותו DB.

תשובה לשאלה 2: חפשו את שם הטבלה שמופיע בתוצאות (לרוב משהו כמו users או שם דומה).

שלב 4: שליפת נתונים (Dumping)
המטרה הסופית היא להוציא את הסיסמה של המשתמש test@chatai.com. אנחנו צריכים לבדוק מה יש בתוך הטבלה שמצאנו.

הפקודה (נניח ששם הטבלה הוא users):

Bash
sqlmap -u 'http://10.113.167.35/ai/includes/user_login?email=test&password=test' --level=5 -D ai -T users --dump
-T users: מציין את שם הטבלה (החליפו במידה והשם שמצאתם שונה).

--dump: מוריד את כל התוכן של הטבלה למסך שלכם.

תשובה לשאלה 3: חפשו בטבלה המודפסת את השורה שבה מופיע האימייל test@chatai.com והעתיקו את הסיסמה (Password) שמופיעה לצידו.

טיפים למקצוענים (Pro-Tips):
חיסכון בזמן: אם אתם כבר יודעים שהפרמטר הפגיע הוא email, תוכלו להוסיף -p email לפקודה כדי ש-SQLMap יתמקד רק בו.

Batch Mode: אם לא בא לכם ללחוץ על y כל הזמן, הוסיפו --batch והכלי יבחר את ברירות המחדל באופן אוטומטי.

<img width="1607" height="729" alt="image" src="https://github.com/user-attachments/assets/133c1164-ff01-42fc-a5c9-21e9d2877046" />

sqlmap -u 'http://10.10.4.209/ai/includes/user_login?email=test&password=test' -D ai -T user --dump

פירוט החלקים:

-D ai: מציין ל-SQLMap להשתמש בבסיס הנתונים שמצאת בשלב הקודם (השם הוא ai).

-T user: מציין את שם הטבלה הספציפית שזיהית (השם הוא user, כפי שמופיע בטבלה המאוירת בתמונה הראשונה).

--dump: זו פקודת ה"פיצוח". היא מורה לכלי להוציא את כל הרשומות (שורות) מתוך הטבלה ולהציג אותן על המסך.

2. מה יקרה אחרי שתלחץ Enter?
SQLMap יתחיל לשלוף את הנתונים. אם יש הרבה משתמשים, זה עשוי לקחת רגע. בסיום, תופיע על המסך טבלה מסודרת עם עמודות כמו id, email, ו-password.

כדי למצוא את הסיסמה של test@chatai.com:

חפש בטבלה שתודפס את השורה שבה מופיע האימייל הזה.

הסיסמה תופיע בעמודה המקבילה באותה שורה.

3. שאלות נפוצות בזמן ההרצה
ייתכן ש-SQLMap ישאל אותך שאלות תוך כדי ה-Dump. מומלץ לענות כך כדי לא להיתקע:

"Do you want to store hashes to a temporary file...?" – השב N (אלא אם אתה רוצה לשמור אותם בצד).

"Do you want to crack them via a dictionary-based attack?" – אם הסיסמאות מוצפנות (Hashes), השב Y כדי ש-SQLMap ינסה לפצח אותן עבורך באופן אוטומטי.

*

> **אזהרה אתית:** תמיד תוסיף למדריך שלך דיסקליימר (Disclaimer) שהשימוש בכלי נועד למטרות לימודיות ומורשות בלבד.

**האם תרצה שאעזור לך לנסח קובץ `README.md` שלם למאגר שלך ב-GitHub עם הסברים מפורטים יותר?**
